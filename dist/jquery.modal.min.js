/*! jQuery Modal - v0.1.0 - 2013-05-13
* https://github.com/amazingSurge/jquery-modal
* Copyright (c) 2013 amazingSurge; Licensed MIT */
(function(n,o,t,e){"use strict";function i(n){return("string"==typeof n||"number"==typeof n)&&!isNaN(n-0)&&""!==n}function a(n){return i(n)?n/2:"string"==typeof n&&"%"===n.charAt(n.length-1)?n.substr(0,n.length-1)/2+"%":e}var s=t.Modal=function(e,i){this.element=e,this.$element=t(e);var a=[];t.each(this.$element.data(),function(n,o){var t=RegExp("^modal","i");t.test(n)&&(a[n.toLowerCase().replace(t,"")]=o)}),this.options=t.extend(!0,{},s.defaults,i,a),t.isArray(this.options.animation)||(this.options.animation=[this.options.animation,this.options.animation]);var l=this.options.namespace;this.$element.addClass(l+"-container");var m=this;t.extend(m,{init:function(){m.$element.on("modal:open",function(){return t.isFunction(m.options.onOpen)&&m.options.onOpen.call(m),m.$element.show().removeClass(l+"-hide"),m.animate(m.$element,m.options.animation[0],m.options.duration),m.position(),!1}),m.$element.on("modal:close",function(){return t.isFunction(m.options.onClose)&&m.options.onClose.call(m),m.animate(m.$element,m.options.animation[1],m.options.duration,null,function(){m.$element.hide().addClass(l+"-hide")}),!1}),m.options.overlay&&this.overlay.setup(),m.options.close&&this.close.setup(),m.options.closeByEscape&&(m.$element.on("modal:open",function(){t(o).on("keydown.modal",function(n){27===n.keyCode&&(n.preventDefault(),m.$element.trigger("modal:close"))})}),m.$element.on("modal:close",function(){t(o).off("keydown.modal")})),m.options.autoPosition&&(m.$element.on("modal:open",function(){t(n).on("resize.modal orientationchange.modal",function(){m.position()})}),m.$element.on("modal:close",function(){t(n).off("resize.modal orientationchange.modal")}))},overlay:{setup:function(){m.$overlay=t('<div class="'+l+'-overlay"></div>').appendTo("body"),m.$element.on("modal:open",function(){m.$overlay.addClass(l+"-show"),m.options.closeByOverlayClick&&m.$overlay.on("click.modal",function(){m.$element.trigger("modal:close")})}),m.$element.on("modal:close",function(){m.$overlay.removeClass(l+"-show"),m.options.closeByOverlayClick&&m.$overlay.off("click.modal")})}},close:{setup:function(){m.options.close===!0&&(m.options.close=l+"-close"),m.$close=m.$element.find(m.options.close),m.$close.on("click",function(){return m.$element.trigger("modal:close"),!1})}},animate:function(n,o,e,i,a){n.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){n.data("animating",!1),t.isFunction(a)&&a(),n.removeClass(l+"-animate "+o)}),n.data("animating")&&n.trigger("webkitAnimationEnd oanimationend msAnimationEnd animationend"),n.addClass(l+"-animate "+o),e&&n.css({"-webkit-animation-duration":e+"ms","-moz-animation-duration":e+"ms","-o-animation-duration":e+"ms","-ms-animation-duration":e+"ms","animation-duration":e+"ms"}),i&&n.css({"-webkit-animation-delay":i+"ms","-moz-animation-delay":i+"ms","-o-animation-delay":i+"ms","-ms-animation-delay":i+"ms","animation-delay":i+"ms"}),n.data("animating",!0)}}),m.init()};s.defaults={animation:["fadeIn","fadeOut"],duration:1e3,namespace:"modal",overlay:!0,close:!1,focus:!0,closeByEscape:!0,closeByOverlayClick:!0,autoPosition:!1,width:null,height:null,position:["50%","50%"],onOpen:null,onClose:null},s.prototype={constructor:s,open:function(){this.$element.trigger("modal:open")},close:function(){this.$element.trigger("modal:close")},position:function(){var n,o;this.options.width?(n=this.options.width,this.$element.width(n)):n=this.$element.width(),this.options.height?(o=this.options.height,this.$element.height(o)):o=this.$element.height(),this.$element.css({marginLeft:a("-"+n),marginTop:a("-"+o),left:this.options.position[0],top:this.options.position[1]})}},t.fn.modal=function(n){if("string"==typeof n){var o=n,i=arguments.length>1?Array.prototype.slice.call(arguments,1):e;return this.each(function(){var n=t.data(this,"modal");"function"==typeof n[o]&&n[o].apply(n,i)})}return this.each(function(){var o=t.data(this,"modal");o||(o=new s(this,n),t.data(this,"modal",o)),o.open()})}})(window,document,jQuery);