/*! jQuery Modal - v0.1.0 - 2013-05-13
* https://github.com/amazingSurge/jquery-modal
* Copyright (c) 2013 amazingSurge; Licensed MIT */
(function(e,o,n,t){"use strict";function i(e){return("string"==typeof e||"number"==typeof e)&&!isNaN(e-0)&&""!==e}function a(e){return i(e)?e/2:"string"==typeof e&&"%"===e.charAt(e.length-1)?e.substr(0,e.length-1)/2+"%":t}var s=n.Modal=function(t,i){this.element=t,this.$element=n(t);var a=[];n.each(this.$element.data(),function(e,o){var n=RegExp("^modal","i");n.test(e)&&(a[e.toLowerCase().replace(n,"")]=o)}),this.options=n.extend(!0,{},s.defaults,i,a),n.isArray(this.options.animation)||(this.options.animation=[this.options.animation,this.options.animation]);var l=this.options.namespace;this.$element.addClass(l+"-container");var m=this;n.extend(m,{init:function(){n.isFunction(m.options.beforeOpen)&&m.$element.on("modal:beforeOpen",m.options.beforeOpen),n.isFunction(m.options.afterOpen)&&m.$element.on("modal:afterOpen",m.options.afterOpen),n.isFunction(m.options.beforeClose)&&m.$element.on("modal:beforeClose",m.options.beforeClose),n.isFunction(m.options.afterClose)&&m.$element.on("modal:afterClose",m.options.afterClose),m.$element.on("modal:open",function(){return m.$element.trigger("modal:beforeOpen"),m.$element.show().removeClass(l+"-hide"),m.position(),m.animate(m.$element,m.options.animation[0],m.options.duration),m.$element.trigger("modal:afterOpen"),!1}),m.$element.on("modal:close",function(){return m.$element.trigger("modal:beforeClose"),m.animate(m.$element,m.options.animation[1],m.options.duration,null,function(){m.$element.hide().addClass(l+"-hide"),m.$element.trigger("modal:afterClose")}),!1}),m.options.overlay&&this.overlay.setup(),m.options.close&&this.close.setup(),m.options.closeByEscape&&(m.$element.on("modal:open",function(){n(o).on("keydown.modal",function(e){27===e.keyCode&&(e.preventDefault(),m.$element.trigger("modal:close"))})}),m.$element.on("modal:close",function(){n(o).off("keydown.modal")})),m.options.autoPosition&&(m.$element.on("modal:open",function(){n(e).on("resize.modal orientationchange.modal",function(){m.position()})}),m.$element.on("modal:close",function(){n(e).off("resize.modal orientationchange.modal")}))},overlay:{setup:function(){m.$overlay=n('<div class="'+l+'-overlay"></div>').appendTo("body"),m.$element.on("modal:beforeOpen",function(){m.$overlay.addClass(l+"-show"),m.animate(m.$overlay,l+"-animate-show",m.options.duration),m.options.closeByOverlayClick&&m.$overlay.on("click.modal",function(){m.$element.trigger("modal:close")})}),m.$element.on("modal:beforeClose",function(){m.animate(m.$overlay,l+"-animate-hide",m.options.duration,null,function(){m.$overlay.removeClass(l+"-show")}),m.options.closeByOverlayClick&&m.$overlay.off("click.modal")})}},close:{setup:function(){m.options.close===!0&&(m.options.close=l+"-close"),m.$close=m.$element.find(m.options.close),m.$close.on("click",function(){return m.$element.trigger("modal:close"),!1})}},animate:function(e,o,t,i,a){e.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e.data("animating",!1),n.isFunction(a)&&a(),e.removeClass(l+"-animate "+o)}),e.data("animating")&&e.trigger("webkitAnimationEnd oanimationend msAnimationEnd animationend"),e.addClass(l+"-animate "+o),t&&e.css({"-webkit-animation-duration":t+"ms","-moz-animation-duration":t+"ms","-o-animation-duration":t+"ms","-ms-animation-duration":t+"ms","animation-duration":t+"ms"}),i&&e.css({"-webkit-animation-delay":i+"ms","-moz-animation-delay":i+"ms","-o-animation-delay":i+"ms","-ms-animation-delay":i+"ms","animation-delay":i+"ms"}),e.data("animating",!0)}}),m.init()};s.defaults={animation:["shake","shake"],duration:1e3,namespace:"modal",overlay:!0,close:!1,focus:!0,closeByEscape:!0,closeByOverlayClick:!0,autoPosition:!1,width:null,height:null,position:["50%","50%"],beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null},s.prototype={constructor:s,open:function(){this.$element.trigger("modal:open")},close:function(){this.$element.trigger("modal:close")},position:function(){var e,o;this.options.width?(e=this.options.width,this.$element.width(e)):e=this.$element.width(),this.options.height?(o=this.options.height,this.$element.height(o)):o=this.$element.height(),this.$element.css({marginLeft:a("-"+e),marginTop:a("-"+o),left:this.options.position[0],top:this.options.position[1]})}},n.fn.modal=function(e){if("string"==typeof e){var o=e,i=arguments.length>1?Array.prototype.slice.call(arguments,1):t;return this.each(function(){var e=n.data(this,"modal");"function"==typeof e[o]&&e[o].apply(e,i)})}return this.each(function(){var o=n.data(this,"modal");o||(o=new s(this,e),n.data(this,"modal",o)),o.open()})}})(window,document,jQuery);