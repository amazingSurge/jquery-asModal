/*! jQuery Modal - v0.1.0 - 2013-05-22
* https://github.com/amazingSurge/jquery-modal
* Copyright (c) 2013 amazingSurge; Licensed MIT */
(function(e,o,n,t){"use strict";function i(e){return("string"==typeof e||"number"==typeof e)&&!isNaN(e-0)&&""!==e}function a(e){return i(e)?e/2:"string"==typeof e&&"%"===e.charAt(e.length-1)?e.substr(0,e.length-1)/2+"%":t}var s=null;n.modal=function(e,t){"string"==typeof e?e=n(e).hide().appendTo("body").get():e instanceof jQuery&&(jQuery.contains(o.documentElement,e[0])||e.appendTo("body"),e=e.get()),s=new l(e,t),s.$element.on("modal:afterClose",function(){n(this).remove()}),s.open()},n.modal.close=function(){if(s){s.close();var e=s.$element;return s=null,e}},n.modal.position=function(){s&&s.position()};var l=function(i,a){this.element=i,this.$element=n(i);var s=[];n.each(this.$element.data(),function(e,o){var n=RegExp("^modal","i");n.test(e)&&(s[e.toLowerCase().replace(n,"")]=o)}),this.options=n.extend(!0,{},l.defaults,a,s),n.isArray(this.options.animation)||(this.options.animation=[this.options.animation,this.options.animation]);var m=this.options.namespace;this.$element.addClass(m+"-container");var r=this;n.extend(r,{init:function(){n.isFunction(r.options.beforeOpen)&&r.$element.on("modal:beforeOpen",r.options.beforeOpen),n.isFunction(r.options.afterOpen)&&r.$element.on("modal:afterOpen",r.options.afterOpen),n.isFunction(r.options.beforeClose)&&r.$element.on("modal:beforeClose",r.options.beforeClose),n.isFunction(r.options.afterClose)&&r.$element.on("modal:afterClose",r.options.afterClose),r.$element.on("modal:open",function(){return r.$element.trigger("modal:beforeOpen"),r.$element.show().removeClass(m+"-hide"),r.position(),r.animate(r.$element,r.options.animation[0],r.options.duration),r.$element.trigger("modal:afterOpen"),!1}),r.$element.on("modal:close",function(){return r.$element.trigger("modal:beforeClose"),r.animate(r.$element,r.options.animation[1],r.options.duration,null,function(){r.$element.hide().addClass(m+"-hide"),r.$element.trigger("modal:afterClose")}),!1}),r.options.overlay&&this.overlay.setup(),r.options.close&&this.closeButton.setup(),r.options.closeByEscape&&(r.$element.on("modal:open",function(){n(o).on("keydown.modal",function(e){27===e.keyCode&&(e.preventDefault(),r.$element.trigger("modal:close"))})}),r.$element.on("modal:close",function(){n(o).off("keydown.modal")})),r.options.autoPosition&&(r.$element.on("modal:open",function(){n(e).on("resize.modal orientationchange.modal",function(){r.position()})}),r.$element.on("modal:close",function(){n(e).off("resize.modal orientationchange.modal")}))},overlay:{setup:function(){r.$overlay=n("."+m+"-overlay"),0===r.$overlay.length&&(r.$overlay=n('<div class="'+m+'-overlay"></div>').appendTo("body")),r.$element.on("modal:beforeOpen",function(){r.$overlay.addClass(m+"-show"),r.animate(r.$overlay,m+"-animate-show",r.options.duration),r.options.closeByOverlayClick&&r.$overlay.on("click.modal",function(){r.$element.trigger("modal:close")})}),r.$element.on("modal:beforeClose",function(){r.animate(r.$overlay,m+"-animate-hide",r.options.duration,null,function(){r.$overlay.removeClass(m+"-show")}),r.options.closeByOverlayClick&&r.$overlay.off("click.modal")})}},closeButton:{setup:function(){r.options.close===!0&&(r.options.close=m+"-close"),r.$close=r.$element.find(r.options.close),r.$close.on("click",function(){return r.$element.trigger("modal:close"),!1})}},animate:function(o,i,a,s,l){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame?(o.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){o.data("animating",!1),n.isFunction(l)&&l(),o.removeClass(m+"-animate "+i)}),o.data("animating")&&o.trigger("webkitAnimationEnd oanimationend msAnimationEnd animationend"),o.addClass(m+"-animate "+i),a&&o.css({"-webkit-animation-duration":a+"ms","-moz-animation-duration":a+"ms","-o-animation-duration":a+"ms","-ms-animation-duration":a+"ms","animation-duration":a+"ms"}),s&&o.css({"-webkit-animation-delay":s+"ms","-moz-animation-delay":s+"ms","-o-animation-delay":s+"ms","-ms-animation-delay":s+"ms","animation-delay":s+"ms"}),o.data("animating",!0),t):(n.isFunction(l)&&l(),t)}}),r.init()};l.defaults={animation:["fadeIn","fadeOut"],duration:1e3,namespace:"modal",overlay:!0,close:!1,focus:!0,closeByEscape:!0,closeByOverlayClick:!0,autoPosition:!1,width:null,height:null,position:["50%","50%"],beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null},l.prototype={constructor:l,open:function(){this.$element.trigger("modal:open"),s=this},close:function(){this.$element.trigger("modal:close")},position:function(){var e,o;this.options.width?(e=this.options.width,this.$element.width(e)):e=this.$element.width(),this.options.height?(o=this.options.height,this.$element.height(o)):o=this.$element.height(),this.$element.css({marginLeft:a("-"+e),marginTop:a("-"+o),left:this.options.position[0],top:this.options.position[1]})}},n.fn.modal=function(e){if("string"==typeof e){var o=e,i=arguments.length>1?Array.prototype.slice.call(arguments,1):t;return this.each(function(){var e=n.data(this,"modal");"function"==typeof e[o]&&e[o].apply(e,i)})}return this.each(function(){var o=n.data(this,"modal");o||(o=new l(this,e),n.data(this,"modal",o)),o.open()})},n(o).on("click.modal","a[data-modal]",function(e){switch(e.preventDefault(),n(this).attr("data-modal")){case"open":var o=n(this).attr("href");/^#/.test(o)&&n(o).modal(n(this).data());break;case"close":n.modal.close()}})})(window,document,jQuery);