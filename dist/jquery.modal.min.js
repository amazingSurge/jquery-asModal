/*! jQuery Modal - v0.2.0 - 2013-05-22
* https://github.com/amazingSurge/jquery-modal
* Copyright (c) 2013 amazingSurge; Licensed MIT */
(function(e,n,o,t){"use strict";function i(e){return("string"==typeof e||"number"==typeof e)&&!isNaN(e-0)&&""!==e}function a(e){return i(e)?e/2:"string"==typeof e&&"%"===e.charAt(e.length-1)?e.substr(0,e.length-1)/2+"%":t}var s=null;o.modal=function(e,t){"string"==typeof e?e=o(e).hide().appendTo("body").get():e instanceof jQuery&&(jQuery.contains(n.documentElement,e[0])||e.appendTo("body"),e=e.get()),s=new l(e,t),s.$element.on("modal:afterClose",function(){o(this).remove()}),s.open()},o.modal.close=function(){if(s){s.close();var e=s.$element;return s=null,e}},o.modal.position=function(){s&&s.position()};var l=function(i,a){this.element=i,this.$element=o(i);var s=[];o.each(this.$element.data(),function(e,n){var o=RegExp("^modal","i");o.test(e)&&(s[e.toLowerCase().replace(o,"")]=n)}),this.options=o.extend(!0,{},l.defaults,a,s),o.isArray(this.options.animation)||(this.options.animation=[this.options.animation,this.options.animation]);var m=this.options.namespace;this.$element.addClass(m+"-container");var r=this;o.extend(r,{init:function(){o.isFunction(r.options.beforeOpen)&&r.$element.on("modal:beforeOpen",r.options.beforeOpen),o.isFunction(r.options.afterOpen)&&r.$element.on("modal:afterOpen",r.options.afterOpen),o.isFunction(r.options.beforeClose)&&r.$element.on("modal:beforeClose",r.options.beforeClose),o.isFunction(r.options.afterClose)&&r.$element.on("modal:afterClose",r.options.afterClose),r.$element.on("modal:open",function(){return r.$element.trigger("modal:beforeOpen"),r.$element.show().removeClass(m+"-hide"),r.position(),r.animate(r.$element,r.options.animation[0],r.options.duration),r.$element.trigger("modal:afterOpen"),!1}),r.$element.on("modal:close",function(){return r.$element.trigger("modal:beforeClose"),r.animate(r.$element,r.options.animation[1],r.options.duration,null,function(){r.$element.hide().addClass(m+"-hide"),r.$element.trigger("modal:afterClose")}),!1}),r.options.overlay&&this.overlay.setup(),r.options.close&&this.closeButton.setup(),r.options.closeByEscape&&(r.$element.on("modal:open",function(){o(n).on("keydown.modal",function(e){27===e.keyCode&&(e.preventDefault(),r.$element.trigger("modal:close"))})}),r.$element.on("modal:close",function(){o(n).off("keydown.modal")})),r.options.autoPosition&&(r.$element.on("modal:open",function(){o(e).on("resize.modal orientationchange.modal",function(){r.position()})}),r.$element.on("modal:close",function(){o(e).off("resize.modal orientationchange.modal")}))},overlay:{setup:function(){r.$overlay=o("."+m+"-overlay"),0===r.$overlay.length&&(r.$overlay=o('<div class="'+m+'-overlay"></div>').appendTo("body")),r.$element.on("modal:beforeOpen",function(){r.$overlay.addClass(m+"-show"),r.animate(r.$overlay,m+"-animate-show",r.options.duration),r.options.closeByOverlayClick&&r.$overlay.on("click.modal",function(){r.$element.trigger("modal:close")})}),r.$element.on("modal:beforeClose",function(){r.animate(r.$overlay,m+"-animate-hide",r.options.duration,null,function(){r.$overlay.removeClass(m+"-show")}),r.options.closeByOverlayClick&&r.$overlay.off("click.modal")})}},closeButton:{setup:function(){r.options.close===!0&&(r.options.close=m+"-close"),r.$close=r.$element.find(r.options.close),r.$close.on("click",function(){return r.$element.trigger("modal:close"),!1})}},animate:function(n,i,a,s,l){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame?(n.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){n.data("animating",!1),o.isFunction(l)&&l(),n.removeClass(m+"-animate "+i)}),n.data("animating")&&n.trigger("webkitAnimationEnd oanimationend msAnimationEnd animationend"),n.addClass(m+"-animate "+i),a&&n.css({"-webkit-animation-duration":a+"ms","-moz-animation-duration":a+"ms","-o-animation-duration":a+"ms","-ms-animation-duration":a+"ms","animation-duration":a+"ms"}),s&&n.css({"-webkit-animation-delay":s+"ms","-moz-animation-delay":s+"ms","-o-animation-delay":s+"ms","-ms-animation-delay":s+"ms","animation-delay":s+"ms"}),n.data("animating",!0),t):(o.isFunction(l)&&l(),t)}}),r.init()};l.defaults={animation:["fadeIn","fadeOut"],duration:1e3,namespace:"modal",overlay:!0,close:!1,spinner:!0,focus:!0,closeByEscape:!0,closeByOverlayClick:!0,autoPosition:!1,width:null,height:null,position:["50%","50%"],beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null},l.prototype={constructor:l,open:function(){this.$element.trigger("modal:open"),s=this},close:function(){this.$element.trigger("modal:close")},showSpinner:function(){this.options.spinner&&(this.$spinner=o("."+this.options.namespace+"-spinner"),0===this.$spinner.length&&(this.$spinner=o('<div class="'+this.options.namespace+'-spinner"></div>').appendTo("body")),this.$spinner.show())},hideSpinner:function(){this.$spinner},position:function(){var e,n;this.options.width?(e=this.options.width,this.$element.width(e)):e=this.$element.width(),this.options.height?(n=this.options.height,this.$element.height(n)):n=this.$element.height(),this.$element.css({marginLeft:a("-"+e),marginTop:a("-"+n),left:this.options.position[0],top:this.options.position[1]})}},o.fn.modal=function(e){if("string"==typeof e){var n=e,i=arguments.length>1?Array.prototype.slice.call(arguments,1):t;return this.each(function(){var e=o.data(this,"modal");"function"==typeof e[n]&&e[n].apply(e,i)})}return this.each(function(){var n=o.data(this,"modal");n||(n=new l(this,e),o.data(this,"modal",n)),n.open()})},o(n).on("click.modal","a[data-modal]",function(e){switch(e.preventDefault(),o(this).attr("data-modal")){case"open":var n=o(this).attr("href");if(/^#/.test(n))o(n).modal(o(this).data());else{var t=o("<div/>").get(),i=new l(t,o(this).data());i.showSpinner(),o.get(n).done(function(e){i.$element.html(e),i.$element.on("modal:afterClose",function(){o(this).remove()}),i.hideSpinner(),i.open()}).fail(function(){i.hideSpinner()})}break;case"close":o.modal.close()}})})(window,document,jQuery);